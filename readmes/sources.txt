input algo - https://gist.github.com/jbaranski/209d475c21fe0459c2499ed606cfad9b
